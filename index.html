<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/custom.css" rel="stylesheet">
  <title>Traffic of Seattle - Leo Kwo GEOG 458 Final Project</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
  <style>
    html,
    body,
    main {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      background: #fff;
      display: flex;
      flex-flow: column;
    }

    #map {
      flex-grow: 1;
    }

    .leaflet-touch .leaflet-control-layers {
      border: 0px;
      background: #242424;
      padding: 20px;
      color: #bababa;
      border-radius: 10px;
    }
  </style>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
</head>

<body>

  <nav class="navbar navbar-expand-md navbar-dark bg-dark" id="override_nav">
    <div class="navbar-brand">Traffic of Seattle, Washington</div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>


    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="index.html">Traffic Map<span class="sr-only">(current)</span></a>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About</a>
          <div class="dropdown-menu" aria-labelledby="dropdown01">
            <a class="dropdown-item" href="more.html">Data Source Information</a>
            <a class="dropdown-item" href="source.html">References</a>
          </div>
        </li>
      </ul>
    </div>
  </nav>
  <div id="map"></div>
  <script type="text/javascript">
    var map = L.map('map', {
      maxZoom: 14,
      minZoom: 12
    }).setView([47.615900, -122.319963], 12);

    var darkmatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png').addTo(map);
    var grayscale = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}@2x.png');
    var streets = L.tileLayer('http://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}@2x.png');
    var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}@2x');

    L.control.scale({position: 'bottomleft'}).addTo(map);

    var traffic = L.tileLayer('assets/tiles/traffic/{z}/{x}/{y}.png', {
      attribution: 'Generated by Leo Kwo | Traffic Flow 2018',
      detectRetina: true
    });

    var beacons = L.tileLayer('assets/tiles/beacon/{z}/{x}/{y}.png', {
      attribution: 'Generated by Leo Kwo | Traffic Beacons Per Tract',
      detectRetina: true
    });

    var collision = L.tileLayer('assets/tiles/collision/{z}/{x}/{y}.png', {
      attribution: 'Generated by Leo Kwo | Collisions Per Tract',
      detectRetina: true
    });

    var cushion = L.tileLayer('assets/tiles/cushion/{z}/{x}/{y}.png', {
      attribution: 'Generated by Leo Kwo | Crash Cushions',
      detectRetina: true
    });

    var baseLayers = {
      'Dark Matter': darkmatter,
      'Grayscale': grayscale,
      'Streets': streets,
      'Satellite': satellite
    };

    var overlays = {
      "Collisions Per Tract": collision,
      "Traffic Beacons Per Tract": beacons,
      "Traffic Flow 2018": traffic,
      "Crash Cushions": cushion
    }

    L.control.layers(baseLayers, overlays, {
      collapsed: false,
      position: 'topright'
    }).addTo(map);

    function styleDiv(div) {
      div.style.background = "#242424";
      div.style.color = "#bababa";
      div.style.padding = "20px";
      div.style["border-radius"] = "10px";
      return div;
    }

    var cushionLegend = L.control({position: 'bottomright'});
    cushionLegend.onAdd = function () {
        var div = L.DomUtil.create('div', 'legend');
        div.innerHTML += '<b>Crash Cushions</b><br />';
        div.innerHTML += '<p><i class="fas fa-circle" style="color: #33a02c"></i> Crash Cushions</p>';
        div = styleDiv(div);
        return div;
    };

    // #f7fbff
    // #dceaf7
    // #bed8ed
    // #8fc2de
    // #5ba3d0
    // #3182be
    // #105ca5
    // #08306b
    var beaconLegend = L.control({position: 'bottomright'});
    beaconLegend.onAdd = function () {
        var div = L.DomUtil.create('div', 'legend');
        div.innerHTML += '<b>Traffic Beacon Per Tract</b><br />';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #f7fbff"></i> 0 - 1 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #dceaf7"></i> 1 - 3 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #bed8ed"></i> 3 - 4 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #8fc2de"></i> 4 - 6 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #5ba3d0"></i> 6 - 9 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #3182be"></i> 9 - 12 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #105ca5"></i> 12 - 15 Beacons</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #08306b"></i> 15 - 21 Beacons</p>';
        div = styleDiv(div);
        return div;
    };

    // #fef0d9
    // #fdcc8a
    // #fc8d59
    // #e34a33
    // #b30000
    var flowLegend = L.control({position: 'bottomright'});
    flowLegend.onAdd = function () {
        var div = L.DomUtil.create('div', 'legend');
        div.innerHTML += '<b>Traffic Flow 2018 (in thousands of vehicles)</b><br />';
        div.innerHTML += '<p><i class="fas fa-slash fa-2x" style="color: #fef0d9"></i> 387 - 7,636 Average Weekday Traffic</p>';
        div.innerHTML += '<p><i class="fas fa-slash fa-2x" style="color: #fdcc8a"></i> 7,636 - 15,261 Average Weekday Traffic</p>';
        div.innerHTML += '<p><i class="fas fa-slash fa-2x" style="color: #fc8d59"></i> 15,261 - 26,148 Average Weekday Traffic</p>';
        div.innerHTML += '<p><i class="fas fa-slash fa-2x" style="color: #e34a33"></i> 26,148 - 45,000 Average Weekday Traffic</p>';
        div.innerHTML += '<p><i class="fas fa-slash fa-2x" style="color: #b30000"></i> 45,000 - 108,179 Average Weekday Traffic</p>';
        div = styleDiv(div);
        return div;
    };

    // #fef0d9
    // #fedcac
    // #fdc383
    // #fd9f67
    // #f57a4e
    // #e75338
    // #cf2a1d
    // #b30000
    var collisionLegend = L.control({position: 'bottomright'});
    collisionLegend.onAdd = function () {
        var div = L.DomUtil.create('div', 'legend');
        div.innerHTML += '<b>Collisions Per Tract</b><br />';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #fef0d9"></i> 2 - 663 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #fedcac"></i> 663 - 1237 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #fdc383"></i> 1237 - 1771 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #fd9f67"></i> 1771 - 2405 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #f57a4e"></i> 2405 - 3493 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #e75338"></i> 3493 - 4661 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #cf2a1d"></i> 4661 - 7590 Collisions</p>';
        div.innerHTML += '<p><i class="fas fa-square" style="color: #b30000"></i> 7590 - 9763 Collisions</p>';
        div = styleDiv(div);
        return div;
    };

    map.on('overlayadd', function (eventLayer) {
      if (eventLayer.name === 'Traffic Beacons Per Tract') {
        beaconLegend.addTo(map);
      } else if (eventLayer.name === 'Traffic Flow 2018') {
        flowLegend.addTo(map);
      } else if (eventLayer.name === 'Collisions Per Tract') {
        collisionLegend.addTo(map);
      } else if (eventLayer.name === 'Crash Cushions') {
        cushionLegend.addTo(map);
      }
    });

    map.on('overlayremove', function (eventLayer) {
      if (eventLayer.name === 'Traffic Beacons Per Tract') {
        map.removeControl(beaconLegend);
      } else if (eventLayer.name === 'Traffic Flow 2018') {
        map.removeControl(flowLegend);
      } else if (eventLayer.name === 'Collisions Per Tract') {
        map.removeControl(collisionLegend);
      } else if (eventLayer.name === 'Crash Cushions') {
        map.removeControl(cushionLegend);
      }
    });

  </script>
</body>

</html>
